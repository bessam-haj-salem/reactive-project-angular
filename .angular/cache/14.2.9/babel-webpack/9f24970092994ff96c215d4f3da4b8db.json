{"ast":null,"code":"import { Observable, Subscription } from 'rxjs';\nconst coalescingManager = createCoalesceManager();\n\nfunction hasKey(ctx, property) {\n  return ctx[property] != null;\n}\n/*\n * createPropertiesWeakMap\n *\n * @param getDefaults: (o: O) => P\n * Example:\n *\n * export interface Properties {\n *   isCoalescing: boolean;\n * }\n *\n * const obj: object = {\n *   foo: 'bar',\n *   isCoalescing: 'weakMap version'\n * };\n *\n * const getDefaults = (ctx: object): Properties => ({isCoalescing: false});\n * const propsMap = createPropertiesWeakMap<object, Properties>(getDefaults);\n *\n * console.log('obj before:', obj);\n * // {foo: \"bar\", isCoalescing: \"weakMap version\"}\n * console.log('props before:', propsMap.getProps(obj));\n * // {isCoalescing: \"weakMap version\"}\n *\n * propsMap.setProps(obj, {isCoalescing: true});\n * console.log('obj after:', obj);\n * // {foo: \"bar\", isCoalescing: \"weakMap version\"}\n * console.log('props after:', propsMap.getProps(obj));\n * // {isCoalescing: \"true\"}\n * */\n\n\nfunction createPropertiesWeakMap(getDefaults) {\n  const propertyMap = new WeakMap();\n  return {\n    getProps: getProperties,\n    setProps: setProperties\n  };\n\n  function getProperties(ctx) {\n    const defaults = getDefaults(ctx);\n    const propertiesPresent = propertyMap.get(ctx);\n    let properties;\n\n    if (propertiesPresent !== undefined) {\n      properties = propertiesPresent;\n    } else {\n      properties = {};\n      Object.entries(defaults).forEach(([prop, value]) => {\n        if (hasKey(ctx, prop)) {\n          properties[prop] = ctx[prop];\n        } else {\n          properties[prop] = value;\n        }\n      });\n      propertyMap.set(ctx, properties);\n    }\n\n    return properties;\n  }\n\n  function setProperties(ctx, props) {\n    const properties = getProperties(ctx);\n    Object.entries(props).forEach(([prop, value]) => {\n      properties[prop] = value;\n    });\n    propertyMap.set(ctx, properties);\n    return properties;\n  }\n}\n\nconst coalescingContextPropertiesMap = createPropertiesWeakMap(ctx => ({\n  numCoalescingSubscribers: 0\n}));\n/**\n * @describe createCoalesceManager\n *\n * returns a\n * Maintains a weak map of component references ans flags\n * them if the coalescing process is already started for them.\n *\n * Used in render aware internally.\n */\n\nfunction createCoalesceManager() {\n  return {\n    remove: removeWork,\n    add: addWork,\n    isCoalescing\n  }; // Increments the number of subscriptions in a scope e.g. a class instance\n\n  function removeWork(scope) {\n    const numCoalescingSubscribers = coalescingContextPropertiesMap.getProps(scope).numCoalescingSubscribers - 1;\n    coalescingContextPropertiesMap.setProps(scope, {\n      numCoalescingSubscribers: numCoalescingSubscribers >= 0 ? numCoalescingSubscribers : 0\n    });\n  } // Decrements the number of subscriptions in a scope e.g. a class instance\n\n\n  function addWork(scope) {\n    const numCoalescingSubscribers = coalescingContextPropertiesMap.getProps(scope).numCoalescingSubscribers + 1;\n    coalescingContextPropertiesMap.setProps(scope, {\n      numCoalescingSubscribers\n    });\n  } // Checks if anybody else is already coalescing atm\n\n\n  function isCoalescing(scope) {\n    return coalescingContextPropertiesMap.getProps(scope).numCoalescingSubscribers > 0;\n  }\n}\n/**\n * @description\n * Limits the number of synchronous emitted a value from the source Observable to\n * one emitted value per\n *   durationSelector e.g. [`AnimationFrame`](https://developer.mozilla.org/en-US/docs/Web/API/Window/requestAnimationFrame), then repeats\n * this process for every tick of the browsers event loop.\n *\n * The coalesce operator is based on the [throttle](https://rxjs-dev.firebaseapp.com/api/operators/throttle) operator.\n * In addition to that is provides emitted values for the trailing end only, as well as maintaining a context to scope\n *   coalescing.\n *\n * @param {function(value: T): Observable} durationSelector - A function\n * that receives a value from the source Observable, for computing the silencing\n * duration for each source value, returned as an Observable or a Promise.\n * It defaults to `requestAnimationFrame` as durationSelector.\n * @param scope\n * Defaults to `{ leading: false, trailing: true }`. The default scoping is per subscriber.\n * @return {Observable<T>} An Observable that performs the coalesce operation to\n * limit the rate of emissions from the source.\n *\n * @usageNotes\n * Emit clicks at a rate of at most one click per second\n * ```typescript\n * import { fromEvent, animationFrames } from 'rxjs';\n * import { coalesce } from 'ngRx/component';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(coalesce(ev => animationFrames));\n * result.subscribe(x => console.log(x));\n * ```\n */\n\n\nfunction coalesceWith(durationSelector, scope) {\n  const _scope = scope || {};\n\n  return source => {\n    return new Observable(observer => {\n      const rootSubscription = new Subscription();\n      rootSubscription.add(source.subscribe(createInnerObserver(observer, rootSubscription)));\n      return rootSubscription;\n    });\n\n    function createInnerObserver(outerObserver, rootSubscription) {\n      let actionSubscription;\n      let latestValue;\n\n      const tryEmitLatestValue = () => {\n        if (actionSubscription) {\n          // We only decrement the number if it is greater than 0 (isCoalescing)\n          coalescingManager.remove(_scope);\n\n          if (!coalescingManager.isCoalescing(_scope)) {\n            outerObserver.next(latestValue);\n          }\n        }\n      };\n\n      return {\n        complete: () => {\n          tryEmitLatestValue();\n          outerObserver.complete();\n        },\n        error: error => outerObserver.error(error),\n        next: value => {\n          latestValue = value;\n\n          if (!actionSubscription) {\n            coalescingManager.add(_scope);\n            actionSubscription = durationSelector.subscribe({\n              error: error => outerObserver.error(error),\n              next: () => {\n                tryEmitLatestValue();\n                actionSubscription === null || actionSubscription === void 0 ? void 0 : actionSubscription.unsubscribe();\n                actionSubscription = undefined;\n              },\n              complete: () => {\n                tryEmitLatestValue();\n                actionSubscription = undefined;\n              }\n            });\n            rootSubscription.add(new Subscription(() => {\n              tryEmitLatestValue();\n              actionSubscription === null || actionSubscription === void 0 ? void 0 : actionSubscription.unsubscribe();\n              actionSubscription = undefined;\n            }));\n          }\n        }\n      };\n    }\n  };\n}\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { coalesceWith, coalescingManager };","map":{"version":3,"names":["Observable","Subscription","coalescingManager","createCoalesceManager","hasKey","ctx","property","createPropertiesWeakMap","getDefaults","propertyMap","WeakMap","getProps","getProperties","setProps","setProperties","defaults","propertiesPresent","get","properties","undefined","Object","entries","forEach","prop","value","set","props","coalescingContextPropertiesMap","numCoalescingSubscribers","remove","removeWork","add","addWork","isCoalescing","scope","coalesceWith","durationSelector","_scope","source","observer","rootSubscription","subscribe","createInnerObserver","outerObserver","actionSubscription","latestValue","tryEmitLatestValue","next","complete","error","unsubscribe"],"sources":["/home/bessam/Documents/Medisail/angular/angular interview/reactive-project-angular/node_modules/@rx-angular/cdk/fesm2015/rx-angular-cdk-coalescing.js"],"sourcesContent":["import { Observable, Subscription } from 'rxjs';\n\nconst coalescingManager = createCoalesceManager();\nfunction hasKey(ctx, property) {\n    return ctx[property] != null;\n}\n/*\n * createPropertiesWeakMap\n *\n * @param getDefaults: (o: O) => P\n * Example:\n *\n * export interface Properties {\n *   isCoalescing: boolean;\n * }\n *\n * const obj: object = {\n *   foo: 'bar',\n *   isCoalescing: 'weakMap version'\n * };\n *\n * const getDefaults = (ctx: object): Properties => ({isCoalescing: false});\n * const propsMap = createPropertiesWeakMap<object, Properties>(getDefaults);\n *\n * console.log('obj before:', obj);\n * // {foo: \"bar\", isCoalescing: \"weakMap version\"}\n * console.log('props before:', propsMap.getProps(obj));\n * // {isCoalescing: \"weakMap version\"}\n *\n * propsMap.setProps(obj, {isCoalescing: true});\n * console.log('obj after:', obj);\n * // {foo: \"bar\", isCoalescing: \"weakMap version\"}\n * console.log('props after:', propsMap.getProps(obj));\n * // {isCoalescing: \"true\"}\n * */\nfunction createPropertiesWeakMap(getDefaults) {\n    const propertyMap = new WeakMap();\n    return {\n        getProps: getProperties,\n        setProps: setProperties,\n    };\n    function getProperties(ctx) {\n        const defaults = getDefaults(ctx);\n        const propertiesPresent = propertyMap.get(ctx);\n        let properties;\n        if (propertiesPresent !== undefined) {\n            properties = propertiesPresent;\n        }\n        else {\n            properties = {};\n            Object.entries(defaults).forEach(([prop, value]) => {\n                if (hasKey(ctx, prop)) {\n                    properties[prop] = ctx[prop];\n                }\n                else {\n                    properties[prop] = value;\n                }\n            });\n            propertyMap.set(ctx, properties);\n        }\n        return properties;\n    }\n    function setProperties(ctx, props) {\n        const properties = getProperties(ctx);\n        Object.entries(props).forEach(([prop, value]) => {\n            properties[prop] = value;\n        });\n        propertyMap.set(ctx, properties);\n        return properties;\n    }\n}\nconst coalescingContextPropertiesMap = createPropertiesWeakMap((ctx) => ({\n    numCoalescingSubscribers: 0,\n}));\n/**\n * @describe createCoalesceManager\n *\n * returns a\n * Maintains a weak map of component references ans flags\n * them if the coalescing process is already started for them.\n *\n * Used in render aware internally.\n */\nfunction createCoalesceManager() {\n    return {\n        remove: removeWork,\n        add: addWork,\n        isCoalescing,\n    };\n    // Increments the number of subscriptions in a scope e.g. a class instance\n    function removeWork(scope) {\n        const numCoalescingSubscribers = coalescingContextPropertiesMap.getProps(scope).numCoalescingSubscribers -\n            1;\n        coalescingContextPropertiesMap.setProps(scope, {\n            numCoalescingSubscribers: numCoalescingSubscribers >= 0 ? numCoalescingSubscribers : 0,\n        });\n    }\n    // Decrements the number of subscriptions in a scope e.g. a class instance\n    function addWork(scope) {\n        const numCoalescingSubscribers = coalescingContextPropertiesMap.getProps(scope).numCoalescingSubscribers +\n            1;\n        coalescingContextPropertiesMap.setProps(scope, {\n            numCoalescingSubscribers,\n        });\n    }\n    // Checks if anybody else is already coalescing atm\n    function isCoalescing(scope) {\n        return (coalescingContextPropertiesMap.getProps(scope).numCoalescingSubscribers >\n            0);\n    }\n}\n\n/**\n * @description\n * Limits the number of synchronous emitted a value from the source Observable to\n * one emitted value per\n *   durationSelector e.g. [`AnimationFrame`](https://developer.mozilla.org/en-US/docs/Web/API/Window/requestAnimationFrame), then repeats\n * this process for every tick of the browsers event loop.\n *\n * The coalesce operator is based on the [throttle](https://rxjs-dev.firebaseapp.com/api/operators/throttle) operator.\n * In addition to that is provides emitted values for the trailing end only, as well as maintaining a context to scope\n *   coalescing.\n *\n * @param {function(value: T): Observable} durationSelector - A function\n * that receives a value from the source Observable, for computing the silencing\n * duration for each source value, returned as an Observable or a Promise.\n * It defaults to `requestAnimationFrame` as durationSelector.\n * @param scope\n * Defaults to `{ leading: false, trailing: true }`. The default scoping is per subscriber.\n * @return {Observable<T>} An Observable that performs the coalesce operation to\n * limit the rate of emissions from the source.\n *\n * @usageNotes\n * Emit clicks at a rate of at most one click per second\n * ```typescript\n * import { fromEvent, animationFrames } from 'rxjs';\n * import { coalesce } from 'ngRx/component';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(coalesce(ev => animationFrames));\n * result.subscribe(x => console.log(x));\n * ```\n */\nfunction coalesceWith(durationSelector, scope) {\n    const _scope = scope || {};\n    return (source) => {\n        return new Observable((observer) => {\n            const rootSubscription = new Subscription();\n            rootSubscription.add(source.subscribe(createInnerObserver(observer, rootSubscription)));\n            return rootSubscription;\n        });\n        function createInnerObserver(outerObserver, rootSubscription) {\n            let actionSubscription;\n            let latestValue;\n            const tryEmitLatestValue = () => {\n                if (actionSubscription) {\n                    // We only decrement the number if it is greater than 0 (isCoalescing)\n                    coalescingManager.remove(_scope);\n                    if (!coalescingManager.isCoalescing(_scope)) {\n                        outerObserver.next(latestValue);\n                    }\n                }\n            };\n            return {\n                complete: () => {\n                    tryEmitLatestValue();\n                    outerObserver.complete();\n                },\n                error: (error) => outerObserver.error(error),\n                next: (value) => {\n                    latestValue = value;\n                    if (!actionSubscription) {\n                        coalescingManager.add(_scope);\n                        actionSubscription = durationSelector.subscribe({\n                            error: (error) => outerObserver.error(error),\n                            next: () => {\n                                tryEmitLatestValue();\n                                actionSubscription === null || actionSubscription === void 0 ? void 0 : actionSubscription.unsubscribe();\n                                actionSubscription = undefined;\n                            },\n                            complete: () => {\n                                tryEmitLatestValue();\n                                actionSubscription = undefined;\n                            },\n                        });\n                        rootSubscription.add(new Subscription(() => {\n                            tryEmitLatestValue();\n                            actionSubscription === null || actionSubscription === void 0 ? void 0 : actionSubscription.unsubscribe();\n                            actionSubscription = undefined;\n                        }));\n                    }\n                },\n            };\n        }\n    };\n}\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { coalesceWith, coalescingManager };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}